import{r as e,S as Pe,B as re,c as ne,u as L,e as Se,n as j,m as Ce,G as qe,d as xe,K as We,l as $e,t as He,E as Ke,y as je,D as G}from"./index-DXBjKzeP.js";import{L as ve}from"./Label-DM50dGsw.js";import{I as Fe}from"./Input-CWRtm-ZM.js";import{T as Ge}from"./Textarea-Dit0N42M.js";import{I as Ne}from"./Icon-DCEecauC.js";import{I as de}from"./InputWithDecorations-iiDSrsjf.js";import{M as Ue}from"./MenuExtraContent-CsGYA1do.js";import{a as Ye,I as ce,b as Je,A as Qe,S as ae}from"./Select-CTqhAUyS.js";import{T as Xe}from"./Text-DcuUQEjC.js";import{S as Ze}from"./SvgCaretDownSmall-CN6cnPu9.js";import{u as _e}from"./useContainerWidth-D82WkVOD.js";import{L as et}from"./List-D8UpYt0H.js";import{u as tt}from"./useVirtualScroll-BTT4fenB.js";import{L as te}from"./ListItem-BDOM0Z9K.js";import{S as rt}from"./SvgCheckmark-B65I9QT-.js";const fe=e.forwardRef((a,u)=>{let{children:c,startIcon:i,status:t,className:s,iconProps:l,contentProps:o,...r}=a,f=i??(t&&Pe[t]()),y=i!==null&&!!f;return e.createElement(re,{className:ne("iui-status-message",s),"data-iui-status":t,ref:u,...r},y?e.createElement(Ne,{"aria-hidden":!0,...l},f):null,e.createElement(re,o,c))}),at=e.forwardRef((a,u)=>{let{label:c,disabled:i,required:t,status:s,message:l,icon:o,isLabelInline:r,children:f,className:y,style:v,statusMessage:b,inputId:I,labelId:C,...m}=a;return e.createElement(re,{className:ne("iui-input-grid",y),"data-iui-status":s,"data-iui-label-placement":r?"inline":void 0,style:v,ref:u,...m},c&&e.createElement(ve,{as:I&&a.as!=="label"?"label":"div",required:t,disabled:i,htmlFor:I,id:C},c),f,b||l&&e.createElement(fe,{startIcon:o,status:s},l))}),me=e.createContext(void 0),U=e.createContext(void 0),nt=e.forwardRef((a,u)=>{let{className:c,children:i,disabled:t,isOpen:s,...l}=a;return e.createElement(Ne,{as:"span",ref:u,className:ne("iui-end-icon",{"iui-disabled":t,"iui-open":s},c),...l},i??e.createElement(Ze,{"aria-hidden":!0}))}),lt=e.forwardRef((a,u)=>{let{selectedItems:c=[],...i}=a;return e.createElement(Ye,{ref:u,tags:c,...i})}),it=e.forwardRef((a,u)=>{let{selectTags:c,size:i,style:t,...s}=a,{isOpen:l,id:o,focusedIndex:r,setFocusedIndex:f,enableVirtualization:y,multiple:v,onClickHandler:b,popover:I,show:C,hide:m}=L(U),{inputRef:le,menuRef:R,optionsExtraInfo:w}=L(me),pe=Se(le,I.refs.setReference,u),k=j(r??-1),be=V=>{var d,h;return((h=(d=R.current)==null?void 0:d.querySelector(`[data-iui-index="${V}"]`))==null?void 0:h.id)??""},Y=e.useCallback(V=>{var h,X,F,Z,N,B,T,A,P,q;let d=Object.keys(w).length??0;if(!V.altKey)switch(V.key){case"ArrowDown":{if(V.preventDefault(),!l)return C();if(d===0)return;if(k.current===-1){let x=(h=R.current)==null?void 0:h.querySelector("[data-iui-index]");return f(Number((x==null?void 0:x.getAttribute("data-iui-index"))??0))}if(y&&!((F=(X=R.current)==null?void 0:X.querySelector(`[data-iui-index="${k.current}"]`))!=null&&F.nextElementSibling))return;let M=k.current;do{let x=(Z=R.current)==null?void 0:Z.querySelector(`[data-iui-index="${M}"]`),S=(x==null?void 0:x.nextElementSibling)??((N=R.current)==null?void 0:N.querySelector("[data-iui-index]"));if(M=Number(S==null?void 0:S.getAttribute("data-iui-index")),S)return f(M)}while(M!==k.current);break}case"ArrowUp":{if(V.preventDefault(),!l)return C();if(d===0||y&&!((T=(B=R.current)==null?void 0:B.querySelector(`[data-iui-index="${k.current}"]`))!=null&&T.previousElementSibling))return;if(k.current===-1)return f(((A=Object.values(w))==null?void 0:A[d-1].__originalIndex)??-1);let M=k.current;do{let x=(P=R.current)==null?void 0:P.querySelector(`[data-iui-index="${M}"]`),S=(x==null?void 0:x.previousElementSibling)??((q=R.current)==null?void 0:q.querySelector("[data-iui-index]:last-of-type"));if(M=Number(S==null?void 0:S.getAttribute("data-iui-index")),S)return f(M)}while(M!==k.current);break}case"Enter":V.preventDefault(),l?k.current>-1&&(b==null||b(k.current)):C();break;case"Escape":V.preventDefault(),m();break;case"Tab":m();break}},[f,y,k,l,R,b,w,C,m]),J=e.useRef(!1),$=e.useCallback(()=>{J.current=l},[l]),O=e.useCallback(()=>{J.current?m():C(),J.current=!1},[m,C]),[H,Q]=_e();return e.createElement(e.Fragment,null,e.createElement(Fe,{ref:pe,"aria-expanded":l,"aria-activedescendant":l&&r!=null&&r>-1?be(r):void 0,role:"combobox","aria-controls":l?`${o}-list`:void 0,"aria-autocomplete":"list",spellCheck:!1,autoCapitalize:"none",autoCorrect:"off",style:{...v&&{paddingInlineStart:Q+18},...t},"aria-describedby":v?`${o}-selected-live`:void 0,size:i,...I.getReferenceProps({...s,onPointerDown:Ce(a.onPointerDown,$),onClick:Ce(a.onClick,O),onKeyDown:Ce(a.onKeyDown,Y)})}),v&&c?e.createElement(lt,{ref:H,selectedItems:c,id:`${o}-selected-live`}):null)}),st=e.forwardRef((a,u)=>{let{className:c,status:i,message:t,children:s,...l}=a,{id:o}=L(U);return e.createElement(at,{className:c,status:i,statusMessage:typeof t=="string"?e.createElement(fe,{status:i},t):e.isValidElement(t)&&e.cloneElement(t,{status:i}),ref:u,...l,id:o},e.createElement(ce,null,s))});let ut=a=>{let{children:u,...c}=a,{filteredOptions:i,getMenuItem:t,focusedIndex:s}=L(U),{menuRef:l}=L(me),o=e.useMemo(()=>{let b=0;for(let I=0;I<Math.min(5,i.length);I++)i[I].sublabel&&b++;return b>=Math.min(3,i.length)},[i]),r=e.useMemo(()=>{var I;let b=(I=l.current)==null?void 0:I.querySelector(`[data-iui-index="${s}"]`);return b?Number(b.getAttribute("data-iui-filtered-index")??s):s},[s,l]),{virtualizer:f,css:y}=tt({count:i.length||1,getScrollElement:()=>l.current,estimateSize:()=>o?48:36,gap:-1});xe(()=>{f.scrollToIndex(r)},[f,r]);let v=e.useCallback(b=>{let I=i.length>0?t(i[b.index],b.index):u;return e.cloneElement(I,{key:b.key,ref:f.measureElement,"data-iui-virtualizer":"item",style:{width:"100%",transform:`translateY(${b.start}px)`}})},[i,t,u,f.measureElement]);return e.createElement(e.Fragment,null,e.createElement(We,{css:y},e.createElement(re,{as:"div","data-iui-virtualizer":"root",...c,style:{minBlockSize:f.getTotalSize(),...a.style}},e.createElement("slot",null))),e.createElement(e.Fragment,null,f.getVirtualItems().map(b=>v(b))))};const ot=e.forwardRef((a,u)=>{let{className:c,children:i,style:t,portal:s=!0,...l}=a,{id:o,enableVirtualization:r,popover:f}=L(U),{menuRef:y}=L(me),v=Se(f.refs.setFloating,u,y);return f.open&&e.createElement(qe,{portal:s},e.createElement(et,{as:"div",className:ne("iui-menu",c),id:`${o}-list`,role:"listbox",ref:v,...f.getFloatingProps({style:r?{maxInlineSize:0,...t}:t,...l})},r?e.createElement(ut,null,i):i))}),dt=e.memo(e.forwardRef((a,u)=>{let{children:c,isSelected:i,disabled:t,value:s,onClick:l,sublabel:o,size:r=o?"large":"default",startIcon:f,endIcon:y,role:v="option",index:b,...I}=a,{focusedIndex:C,enableVirtualization:m}=L(U),R=Se(u,w=>{!m&&C===b&&(w==null||w.scrollIntoView({block:"nearest"}))});return e.createElement(te,{as:"div",actionable:!0,size:r,active:i,disabled:t,focused:C===b,ref:R,onClick:()=>l==null?void 0:l(s),role:v,tabIndex:v==="presentation"?void 0:-1,"aria-selected":i,"aria-disabled":t,"data-iui-index":b,...I},f&&e.createElement(te.Icon,{as:"span","aria-hidden":!0},f),e.createElement(te.Content,null,c,o&&e.createElement(te.Description,null,o)),y||i&&e.createElement(te.Icon,{as:"span","aria-hidden":!0},y??e.createElement(rt,null)))}));let D=(a,u)=>u&&(Array.isArray(a)||a==null),ct=(a,u)=>!u,ze=(a,u)=>a.id??`${u}-option-${a.label.replace(/\s/g,"-")}`;const ke=e.forwardRef((a,u)=>{var Me;let c=$e(),i=e.useCallback((n,p)=>n.filter(g=>g.label.toLowerCase().includes(p.toLowerCase())),[]),{options:t,value:s,onChange:l,filterFunction:o=i,inputProps:r,endIconProps:f,dropdownMenuProps:{middleware:y,...v}={},emptyStateMessage:b="No options found",itemRenderer:I,enableVirtualization:C=!1,multiple:m=!1,onShow:le,onHide:R,id:w=r!=null&&r.id?`iui-${r.id}-cb`:c,defaultValue:pe,clearFilterOnOptionToggle:k=!0,...be}=a,Y=e.useRef(null),J=e.useRef(null),$=j(l),O=j(t),H=j(o),Q=e.useMemo(()=>{let n={};return t.forEach((p,g)=>{n[ze(p,w)]={__originalIndex:g}}),n},[w,t]),V=e.useCallback(n=>{if(n!==void 0){if(D(n,m)){let p=[];return n==null||n.forEach(g=>{let E=t.findIndex(z=>z.value===g);E>-1&&p.push(E)}),p}return t.findIndex(p=>p.value===n)}},[m,t]),[d,h]=He(V(pe)??(m?[]:-1),V(s)),X=e.useRef(s);xe(()=>{s!==X.current&&(X.current=s,s===void 0&&(D(d,m)?h([]):h(-1)))},[m,d,h,s]);let[F,Z]=e.useState(!1),[N,B]=e.useState(-1),T=j(le),A=j(R),P=e.useCallback(()=>{var n;Z(!0),(n=T.current)==null||n.call(T)},[T]),q=e.useCallback(()=>{var n;Z(!1),(n=A.current)==null||n.call(A)},[A]);xe(()=>{var n,p;F?((n=Y.current)==null||n.focus(),D(d,m)||B(d??-1)):(B(-1),D(d,m)?S(""):S(d>=0?((p=O.current[d])==null?void 0:p.label)??"":""),ge(!1))},[F,m,O,d]);let M=e.useRef(t);e.useEffect(()=>{t!==M.current&&(M.current=t,n());function n(){var p;D(d,m)?B(-1):B(d),!D(d,m)&&!F&&S(d>=0?(p=t[d])==null?void 0:p.label:"")}},[t,F,m,d]);let[x,S]=e.useState(((Me=r==null?void 0:r.value)==null?void 0:Me.toString())??""),[Re,ge]=e.useState(!1),Ie=e.useMemo(()=>{var n;return Re?(n=H.current)==null?void 0:n.call(H,t,x):t},[H,x,t,Re]),[Be,De]=e.useState(""),Le=e.useCallback(n=>{var g;let{value:p}=n.currentTarget;S(p),P(),ge(!0),N!=-1&&B(-1),(g=r==null?void 0:r.onChange)==null||g.call(r,n)},[N,r,P]),_=e.useCallback(n=>D(d,m)?d.includes(n):d===n,[m,d]),we=e.useCallback((n,p)=>{if(D(d,m))return p==="added"?[...d,n]:d==null?void 0:d.filter(g=>g!==n)},[d,m]),Ee=e.useCallback((n,p,g)=>{var E,z,K,W;ct($.current,m)?(z=$.current)==null||z.call($,(E=O.current[n])==null?void 0:E.value):p&&g&&((W=$.current)==null||W.call($,g==null?void 0:g.map(ye=>{var se;return(se=O.current[ye])==null?void 0:se.value}),{value:(K=O.current[n])==null?void 0:K.value,type:p}))},[m,$,O]),ie=e.useCallback(n=>{var p,g;if((p=Y.current)==null||p.focus({preventScroll:!0}),!((g=O.current[n])!=null&&g.disabled))if(m){let E=_(n)?"removed":"added",z=we(n,E);if(z==null)return;h(z),Ee(n,E,z),De(z.map(K=>{var W;return(W=O.current[K])==null?void 0:W.label}).filter(Boolean).join(", ")),k&&(S(""),ge(!1))}else h(n),q(),Ee(n)},[O,m,_,we,h,Ee,k,q]),he=e.useCallback((n,p)=>{let g=ze(n,w),{__originalIndex:E}=Q[g],{icon:z,startIcon:K,label:W,...ye}=n,se=K??z,ue=I?I(n,{isFocused:N===E,isSelected:_(E),index:E,id:g}):null;return ue?e.cloneElement(ue,{onClick:ee=>{var Oe,Ve;ie(E),(Ve=(Oe=ue.props).onClick)==null||Ve.call(Oe,ee)},focused:N===E,"data-iui-index":E,"data-iui-filtered-index":p,ref:Ke(ue.props.ref,ee=>{!C&&N===E&&(ee==null||ee.scrollIntoView({block:"nearest"}))})}):e.createElement(dt,{key:g,id:g,startIcon:se,...ye,isSelected:_(E),onClick:()=>{ie(E)},index:E,"data-iui-filtered-index":p},W)},[C,N,w,_,I,ie,Q]),Te=e.useMemo(()=>e.createElement(e.Fragment,null,e.isValidElement(b)?b:e.createElement(Ue,null,e.createElement(Xe,{isMuted:!0},b))),[b]),Ae=je({visible:F,onVisibleChange:n=>n?P():q(),matchWidth:!0,middleware:{size:{maxHeight:"var(--iui-menu-max-height)"},...y},closeOnOutsideClick:!0,interactions:{click:!1,focus:!0}});return e.createElement(me.Provider,{value:{inputRef:Y,menuRef:J,optionsExtraInfo:Q}},e.createElement(U.Provider,{value:{id:w,isOpen:F,focusedIndex:N,setFocusedIndex:B,onClickHandler:ie,enableVirtualization:C,filteredOptions:Ie,getMenuItem:he,multiple:m,popover:Ae,show:P,hide:q}},e.createElement(st,{ref:u,disabled:r==null?void 0:r.disabled,...be},e.createElement(e.Fragment,null,e.createElement(it,{value:x,disabled:r==null?void 0:r.disabled,...r,onChange:Le,selectTags:D(d,m)?d==null?void 0:d.map(n=>{let p=t[n];return e.createElement(Je,{key:p.label,label:p.label})}).filter(Boolean):void 0})),e.createElement(nt,{...f,disabled:r==null?void 0:r.disabled,isOpen:F}),m?e.createElement(Qe,{text:Be}):null),e.createElement(ot,{as:"div",...v},Ie.length>0&&!C?Ie.map(he):Te)))}),Vt=e.forwardRef((a,u)=>{let{children:c,className:i,labelPlacement:t,...s}=a,l=ft(c);return e.createElement(re,{className:ne("iui-input-grid",i),"data-iui-label-placement":t,ref:u,...s},l)});let ft=a=>{let{labelId:u,inputId:c,messageId:i}=mt(a);return e.useMemo(()=>e.Children.map(a,t=>e.isValidElement(t)?t.type===ve||t.type==="label"?G(t,s=>({...s.props,htmlFor:s.props.htmlFor||c,id:s.props.id||u})):t.type===fe?G(t,s=>({...s.props,id:s.props.id||i})):oe(t)||t.type===de||t.type===ce?pt(t,{labelId:u,inputId:c,messageId:i}):t:t),[a,c,u,i])},mt=a=>{let u=$e(),c,i,t,s=!1,l=!1,o=r=>{var f;if(e.isValidElement(r)){if(r.type===ke)return((f=r.props.inputProps)==null?void 0:f.id)||`${u}--input`;if(r.type!==ae)return r.props.id||`${u}--input`}};return e.Children.forEach(a,r=>{e.isValidElement(r)&&((r.type===ve||r.type==="label")&&(s=!0,c||(c=r.props.id||`${u}--label`)),r.type===fe&&(t||(t=r.props.id||`${u}--message`)),r.type===de||r.type===ce?e.Children.forEach(r.props.children,f=>{oe(f)&&(i||(i=o(f)))}):oe(r)&&(i||(i=o(r))),r.type===ae&&(l=!0))}),{labelId:l?c:void 0,inputId:s&&!l?i:void 0,messageId:t}},pt=(a,{labelId:u,inputId:c,messageId:i})=>{let t=(l={})=>{let o=[l["aria-describedby"],i].filter(Boolean).join(" ");return{...l,...a.type!==ae&&{id:l.id||c},"aria-describedby":(o==null?void 0:o.trim())||void 0}},s=l=>l.type===ke?G(l,o=>({inputProps:t(o.props.inputProps)})):l.type===ae?G(l,o=>({triggerProps:{"aria-labelledby":u,...t(o.props.triggerProps)}})):G(l,o=>t(o.props));return a.type===de||a.type===ce?G(a,l=>({children:e.Children.map(l.props.children,o=>e.isValidElement(o)&&oe(o)?s(o):o)})):s(a)},oe=a=>e.isValidElement(a)&&(a.type==="input"||a.type==="textarea"||a.type==="select"||a.type===Fe||a.type===Ge||a.type===de.Input||a.type===ae||a.type===ke);export{ke as C,Vt as I,fe as S};
