import{r as e,q as A,d as F,B as L,c as z,m as B,n as O,P as q,y as H}from"./index-DcTlL2oN.js";import{g as U}from"./focusable-DQv_vybo.js";import{L as d}from"./ListItem-CLNx_BW0.js";import{u as j}from"./Popover-DjArJ8lA.js";const G=c=>e.createElement(A,{...c},e.createElement("path",{d:"M6.003 4.807v6.4a.28.28 0 0 0 .443.24L9.9 8.27a.34.34 0 0 0 0-.48L6.446 4.566a.269.269 0 0 0-.443.24z"})),J=e.forwardRef((c,I)=>{const{setFocus:p=!0,className:g,...u}=c,[l,a]=e.useState(),i=e.useRef(null),E=F(i,I),m=e.useCallback(()=>{const t=U(i.current);return t.filter(n=>!t.some(r=>r.contains(n.parentElement)))},[]);e.useEffect(()=>{var r;const t=m();if(l!=null){(r=t==null?void 0:t[l])==null||r.focus();return}const n=t.findIndex(s=>s.getAttribute("aria-selected")==="true");p&&a(n>-1?n:0)},[p,l,m]);const h=t=>{if(t.altKey)return;const n=m();if(!(n!=null&&n.length))return;const r=l??0;switch(t.key){case"ArrowDown":{a(Math.min(r+1,n.length-1)),t.preventDefault(),t.stopPropagation();break}case"ArrowUp":{a(Math.max(r-1,0)),t.preventDefault(),t.stopPropagation();break}}};return e.createElement(L,{as:"div",className:z("iui-menu",g),role:"menu",ref:E,...u,onKeyDown:B(c.onKeyDown,h)})}),V=e.createContext({ref:void 0,setIsNestedSubmenuVisible:()=>{}}),_=e.forwardRef((c,I)=>{const{children:p,isSelected:g,disabled:u,value:l,onClick:a,sublabel:i,size:E=i?"large":"default",icon:m,startIcon:h=m,badge:t,endIcon:n=t,role:r="menuitem",subMenuItems:s=[],...x}=c,w=e.useRef(null),[N,D]=e.useState(!1),y=O(),[k,S]=e.useState(!1),[K,C]=e.useState(!1),b=e.useContext(V),f=j({visible:k||K,onVisibleChange:o=>{S(o),b.setIsNestedSubmenuVisible(o)},placement:"right-start",trigger:{hover:!0,focus:!0}}),P={onClick:()=>!u&&(a==null?void 0:a(l)),onKeyDown:o=>{var R,v,M;if(!o.altKey)switch(o.key){case"Enter":case" ":case"Spacebar":{!u&&(a==null||a(l)),o.preventDefault();break}case"ArrowRight":{s.length>0&&(S(!0),H.flushSync(()=>D(!0)),D(!1),o.preventDefault(),o.stopPropagation());break}case"ArrowLeft":{b.ref&&((R=b.ref.current)==null||R.focus(),b.setIsNestedSubmenuVisible(!1)),o.stopPropagation(),o.preventDefault();break}case"Escape":{(M=(v=b.ref)==null?void 0:v.current)==null||M.focus();break}}}};return e.createElement(d,{as:"div",actionable:!0,size:E,active:g,disabled:u,ref:F(w,I,s.length>0?f.refs.setReference:null),role:r,tabIndex:u||r==="presentation"?void 0:-1,"aria-selected":g,"aria-haspopup":s.length>0?"true":void 0,"aria-controls":s.length>0?y:void 0,"aria-expanded":s.length>0?f.open:void 0,"aria-disabled":u,...s.length===0?{...P,...x}:f.getReferenceProps({...P,...x})},h&&e.createElement(d.Icon,{as:"span","aria-hidden":!0},h),e.createElement(d.Content,null,e.createElement("div",null,p),i&&e.createElement(d.Description,null,i)),!n&&s.length>0&&e.createElement(d.Icon,{as:"span","aria-hidden":!0},e.createElement(G,null)),n&&e.createElement(d.Icon,{as:"span","aria-hidden":!0},n),s.length>0&&f.open&&e.createElement(q,null,e.createElement(V.Provider,{value:{ref:w,setIsNestedSubmenuVisible:C}},e.createElement(J,{setFocus:N,ref:f.refs.setFloating,...f.getFloatingProps({id:y,onPointerMove:()=>{S(!0)}})},s))))});export{_ as M,J as a};
